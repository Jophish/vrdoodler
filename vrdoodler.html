<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <title>VRDoodler!!!</title>
 
</head>
 <link rel="stylesheet" href="css/style.css">
     <script type="text/javascript" src="http://code.jquery.com/jquery-latest.pack.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r73/three.js"></script>
<script src="http://threejs.org/examples/js/controls/OrbitControls.js"></script>
<!--<script src="js/controls/OrbitControls.js"></script>-->
<!--<script src="js/shaders/LineDisplacementShader.js"></script>-->

	<script src="js/exporters/OBJExporter.js"></script>
	<script src="js/loaders/OBJLoader.js"></script>



 <script id="vertexShader" type="x-shader/x-vertex">  
      
	varying vec2 vUv;
	uniform float color;
	varying float noise;
	uniform float time;
	
	
	
	
	void main() {
	
		vUv = uv;
	
		// add time to the noise parameters so it's animated
		//noise = 15.0 *  -.10 * turbulence( .2 * normal + time );
		//float b = 2.0 * pnoise( 0.05 * position + vec3( 2.0 * time ), vec3( 2.0 ) );
		//float displacement = noise/.5;
		//- noise + b;
		//sin(fTimer+Tex.x*10)*0.01f;
		//	float newXPosition = sin(time + position.x * 2.)  ;
		
		gl_Position = projectionMatrix * modelViewMatrix * vec4( position,1.0 );
	
	}
               
    </script>

    <script id="fragmentShader" type="x-shader/x-fragment">

    varying vec2 vUv;
	uniform float color;
	void main() {

    // colour is RGBA: u, v, 0, 1
	gl_FragColor = vec4( vec3(color), 1. );

	}
    </script>
    
    <script src="js/shaders/LineDisplacementShader.js"></script>
    
    
<div class="hero-unit">
	<h2>VRDoodler!</h2>
	<ul>
	<li><input id="draw" type="checkbox" value="draw"/><span>d</span>raw</li>
	<li><form><input id="snapTo" type="radio" name="mode" value="snapTo" /><span>s</span>nap To<input id="freehand" type="radio"  name="mode" value="freehand" checked/>freehand </form></li>
	<li>Press <span>Shift</span> to Square Along Grid<select id="toggleCameraPlaneLock" value="0" enabled="false"/>
		<option value="0">None</option>
		<option value="1">vertical Lock</option>
		<option value="2">horizontal Lock</option>
		<option value="3">Both</option>
		</select> 
	
	</li>
	<li><input id="rotateX" type="checkbox" value="rotate90" enabled="false"/><span>r</span>rotate 90</li>
	<li>Line Width
		<select id="width" type="text" value="2" enabled="true"/></li>
		<option value="2">2</option>
		<option value="4">4</option>
		<option value="4">6</option>
		<option value="4">8</option>
		<option value="4">10</option>
		</select> 
		<br/>
	<input id="exportLine" type="button" value="Export" enabled="false"/>
	<br/>
	<input id="grid" type="checkbox" value="toggleGrid" enabled="false"/><span>g</span>rid
	</ul>
	<label id="mousecoords" value="">
	<!--
	<input id="width" type="checkbox" value="lineWidth" enabled="false"/>Line Width
	<input id="trace" type="checkbox" value="trace" enabled="false"/>Trace
	
	<input id="colorToggle" type="checkbox" value="colorToggle" enabled="false"/>Color-->
</div>    
<div id="infoPanel">
 <h3>Log:</h3>
   </div>
    <!--<a id="turnedoffinfoPanelTag" href="#menu" class="gradient-menu"></a>-->
    <br>
<script src="VRDoodler.js"></script>
<script>
//import {VRDoodler} from 'VRDoodler';
function animate (doodle){
	requestAnimationFrame(animate);
	Doodler.animate();
}
//problem currently with using VRDoodler.animate() as a callback inside the global animate 
//function, problem is in the scope of "this". Workaround currently by using Doodler as
//a global var, ugly but works.

Doodler = new VRDoodler();
Doodler.init();
//set up some basic function calls that occur on scpecific events
		window.addEventListener('resize', Doodler.onWindowResize, false);
		document.addEventListener('mousedown', Doodler.onSketchMouseDown, false);
		document.addEventListener( 'mousemove', Doodler.onDocumentMouseMove, false );
		
    
		//basically call some functions when we see a click on an html element
		document.getElementById('draw').onclick = Doodler.toggleDrawMode;
		document.getElementById('snapTo').onclick = Doodler.snapTo;
		document.getElementById('freehand').onclick = Doodler.snapTo;
		document.getElementById('exportLine').onclick = Doodler.exportToObj;
		document.getElementById('width').onchange = Doodler.setCurrentLineWidth;
		document.getElementById('grid').onclick = Doodler.toggleGrid;
		document.getElementById('toggleCameraPlaneLock').onchange= Doodler.toggleCameraPlaneLock;
		document.getElementById('rotateX').onclick = Doodler.rotateX;

        //listen for keypresses, if we hear them, execute the callback function    
        document.addEventListener( 'keydown', Doodler.onVRDoodlerKeyDown, false );
		document.addEventListener( 'keyup', Doodler.onVRDoodlerKeyUp, false );
animate();
</script>
</html>